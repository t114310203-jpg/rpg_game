# 名偵探柯南：諾亞方舟防衛戰 🕵️

> 一款基於 C++ 開發的文字 RPG 遊戲，以名偵探柯南世界觀為背景，融合戰鬥、探索、劇情推進與策略養成系統。

## 📖 遊戲簡介

黑衣組織企圖攻占位於太平洋中心的「五稜星」設施，奪取掌管全球隱私資料的 AI 系統「諾亞方舟」。柯南與夥伴們必須深入設施各層，擊敗組織的精英成員，並在最終的深海伺服器室阻止琴酒的陰謀。

### 遊戲特色

- 🎮 **回合制戰鬥系統**：技能冷卻、爆擊判定、閃避機制
- 👥 **多職業角色系統**：道具專家、格鬥家、後勤、特殊四大職業
- 📜 **章節劇情推進**：8 個章節，隨著戰鬥與探索解鎖新劇情
- 🗺️ **地點探索**：從警視廳到深海伺服器室，7 個獨特地點
- 💰 **商店與背包系統**：購買道具、管理裝備
- 🎲 **隨機事件**：搜查時可能遇見新夥伴或觸發特殊事件
- 🎯 **BOSS 戰削弱機制**：收集線索可降低 BOSS 戰鬥難度

---

## 🎭 角色職業介紹

### Gadgeteer（道具專家）
**代表角色**：江戶川柯南  
**成長數值**：HP +60/lv | ATK +5/lv | INT +12/lv | LUCK +8/lv  
**技能**：
- 腳力增強鞋（ATK x2.0 + 10，CD:2）
- 麻醉手錶（INT x1.5 + 20，CD:4）
- 領結變聲器（INT x1.2，CD:3）

### Fighter（格鬥家）
**代表角色**：毛利蘭、服部平次、京極真、赤井秀一、安室透、遠山和葉  
**成長數值**：HP +100/lv | ATK +10/lv | INT +3/lv | LUCK +5/lv  
**技能**（依類型而異）：
- **Karate**：空手道劈擊、迴旋踢
- **Kendo**：劍道突刺、居合斬
- **Super**：正拳突刺、迴旋踢
- **Sniper**：銀色子彈、截拳道
- **SecretPolice**：零之執行、博擊
- **Aikido**：合氣道摔、護身符

### Support（後勤）
**代表角色**：灰原哀、阿笠博士、鈴木園子、工藤優作  
**成長數值**：HP +50/lv | ATK +3/lv | INT +15/lv | LUCK +6/lv  
**技能**（依類型而異）：
- **Science**：應急處置（治療）、化學知識
- **Inventor**：冷謎語、應急處置
- **Rich**：鈔能力、應急處置（+20 幸運加成）
- **Novelist**：世界級推理、冷靜分析

### Trickster（特殊）
**代表角色**：怪盜基德、毛利小五郎、工藤有希子  
**成長數值**：HP +80/lv | ATK +6/lv | INT +8/lv | LUCK +15/lv  
**技能**（依類型而異）：
- **Thief**：撲克牌槍、化學炸彈
- **Sleep**：過肩摔、沉睡推理
- **Actress**：易容術、暗夜男爵夫人

---

## 🎮 遊戲系統說明

### 戰鬥系統

- **回合制**：我方全員行動 → 怪物反擊 → 冷卻倒數 → 下一回合
- **行動選項**：
  - 普通攻擊（0.8-1.2 倍浮動傷害）
  - 技能（冷卻制，可能造成高傷害或治療）
  - 使用道具（恢復 HP / 復活隊友）
- **爆擊機制**：依幸運值判定，1.5 倍傷害
- **閃避機制**：依幸運值判定，完全迴避怪物攻擊
- **削弱機制**：
  - BOSS 戰前消耗 5 線索 → 降低 30% HP/ATK
  - Elite 戰前消耗 3 線索 → 降低 20% HP/ATK

### 怪物類型

- **NORMAL**：普通小怪（組織外圍成員、武裝蛙人等）
- **ELITE**：精英敵人（菁英狙擊手、駭客首領等）
- **BOSS**：章節 BOSS（基爾、苦艾酒、伏特加、琴酒）

### 地點系統

| ID | 地點名稱 | 敵人強度 | 金錢掉落 | 調查加成 | 解鎖章節 |
|----|----------|----------|----------|----------|----------|
| 0 | 警視廳 | 0.8x | 0.8x | +30% | Ch.0 |
| 1 | 阿笠博士家 | 1.0x | 1.0x | +20% | Ch.0 |
| 2 | 太平洋巡邏艦 | 1.2x | 1.2x | +10% | Ch.2 |
| 3 | 五稜星大廳 | 1.4x | 1.5x | +5% | Ch.3 |
| 4 | 中央控制室 | 1.6x | 1.8x | 0% | Ch.4 |
| 5 | 地下維修通道 | 1.8x | 2.0x | -10% | Ch.5 |
| 6 | 水下伺服器室 | 2.2x | 2.5x | -5% | Ch.6 |
| 7 | 外部水域 | 3.0x | 5.0x | +10% | Ch.7 |

### 劇情章節

- **Ch.0 序章**：警視廳的暗流
- **Ch.1**：鈴木財團的邀請函
- **Ch.2**：駛向太平洋
- **Ch.3**：諾亞方舟的凝視（基爾 BOSS）
- **Ch.4**：黑衣的入侵者（苦艾酒 BOSS）
- **Ch.5**：伺服器過熱（伏特加 BOSS）
- **Ch.6**：伺服器攻防戰（琴酒 BOSS）
- **Ch.7**：深海的逆轉
- **Ch.8 終章**：黎明前的五稜星

---

## 🛠️ 編譯與執行

### 系統需求

- C++ 編譯器（支援 C++11 或更高版本）
- Windows / Linux / macOS
- 終端機支援 UTF-8 與 ANSI 顏色代碼

### 編譯指令

#### Windows (MinGW / MSYS2)
```bash
g++ -std=c++11 project.cpp -o game.exe
.\game.exe
```

#### Linux / macOS
```bash
g++ -std=c++11 project.cpp -o game
./game
```

#### VS Code 任務（已配置）
按下 `Ctrl+Shift+B` 選擇 **C/C++: g++.exe 建置使用中檔案**

---

## 🕹️ 操作說明

### 主選單

```
1. 戰鬥     - 遭遇隨機敵人或 BOSS
2. 移動     - 切換地點（需達成解鎖條件）
3. 商店     - 購買恢復道具與復活道具
4. 隊伍     - 查看成員、使用道具、替換隊友
5. 搜查     - 獲得線索、可能遇見新夥伴
0. 退出遊戲
```

### 戰鬥選單

```
1. 普通攻擊
2-4. 技能（依角色而異，顯示冷卻狀態）
5. 使用道具
```

### 道具列表

- **波羅麵包**（100 円）：恢復 50 HP
- **鰻魚飯**（300 円）：恢復 100 HP
- **阿笠博士特製藥**（500 円）：恢復 200 HP
- **急救箱**（600 円）：復活並恢復 50% HP

---

## 🎯 遊戲攻略建議

1. **初期多搜查**：累積線索數量，為後續 BOSS 戰做準備
2. **平衡隊伍組成**：建議至少 1 名 Support 角色提供治療
3. **善用技能冷卻**：高傷技能留給 BOSS，小怪用普攻節省 CD
4. **線索運用**：
   - Elite 戰前有 3+ 線索建議使用（省血省時間）
   - BOSS 戰前務必存夠 5 線索削弱
5. **金錢管理**：優先購買急救箱（復活）與特製藥（高回復）
6. **隊伍替換**：搜查時可能遇見稀有角色（5% 機率），適時替換弱勢成員

---

## 📊 技術細節

### 設計模式

- **繼承與多型**：`Character` 抽象基類 → `Gadgeteer`、`Fighter`、`Support`、`Trickster`
- **策略模式**：`Skill` 抽象基類 → `AttackSkill`、`HealSkill`
- **組合模式**：`Character` 擁有多個 `Skill` 指標
- **工廠模式**：`createRandomNPC()` 隨機生成角色實例

### 核心機制

- **經驗值公式**：`升級所需 = (level)² × 100`
- **怪物強度計算**：`隊伍平均戰力 × 地點修正係數`
- **爆擊判定**：`隨機(1-100) ≤ 角色幸運值 → 1.5x 傷害`
- **閃避判定**：`隨機(1-100) < 角色速度(=幸運) → 完全迴避`

### 記憶體管理

- 使用 `new` / `delete` 管理動態物件
- 遊戲結束時完整清理角色、技能、道具指標
- `resetGame()` 函式確保重新開始時無記憶體洩漏

---

## 📁 專案結構

```
project/
├── project.cpp            # 主程式
├── 113-11.cpp             # (舊版參考)
├── README.md              # 本文件
├── ClassDiagram.md        # 類別圖（Mermaid）
├── ClassDiagram_Split.md  # 分拆類別圖
├── flowchart.md           # 流程圖
└── 變更紀錄.md             # 版本變更紀錄
```

---

## 🐛 已知問題與限制

- Windows 控制台可能需要執行 `chcp 65001` 以正確顯示 UTF-8 中文
- ANSI 顏色在部分終端機可能無法正常顯示
- 隊伍全滅後直接重新開始（無讀檔機制）

---

## 📝 授權與致謝

- **開發者**：[Chia]
- **開發日期**：2025年12月
- **靈感來源**：名偵探柯南（Detective Conan）
- **程式語言**：C++11
- **開發環境**：VS Code

---

## 🎊 結語

> 「真相只有一個！」  
> 挑戰極限，守護諾亞方舟，阻止黑衣組織的野心吧！

**祝遊戲愉快！🎮**
